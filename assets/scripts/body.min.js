function adjustDescriptionAreaHeight(){var e,t,n=document.querySelector(".page-header-section");n?(e=n.firstElementChild)?((e=e instanceof HTMLElement?e.offsetHeight:0)||console.warn("[adjustDescriptionAreaHeight] contentHeight is not found!"),t=e+38+"px",n instanceof HTMLElement&&parseInt(n.style.height,10)!==e+38&&(n.style.height=t)):console.warn("[adjustDescriptionAreaHeight] contentWrapper is not found!"):console.warn("[adjustDescriptionAreaHeight] descriptionArea is not found!")}function replaceWithYouTubeEmbeddedPlayer(){var e,t=document.querySelectorAll("p.embed-yt-vid"),n=t.length;console.info(`[replaceWithYouTubeEmbeddedPlayer] ${1===n?"a":n} YouTube Video ID${1===n?" was":"s were"} found.`+(0!==n?" Embedding players...":""));for(e of t){var o,r,a=e.textContent?.trim();a?/^[a-zA-Z0-9_-]{11}$/.test(a)?((o=document.createElement("iframe")).src="https://www.youtube-nocookie.com/embed/"+a,o.frameBorder="0",o.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",o.allowFullscreen=!0,o.classList.add("embedded-youtube-video"),(r=e.parentNode)?r.replaceChild(o,e):console.warn("[replaceWithYouTubeEmbeddedPlayer] parentNode is not found!",e)):console.warn(`[replaceWithYouTubeEmbeddedPlayer] ${a} is not valid YouTube video ID!`):console.warn("[replaceWithYouTubeEmbeddedPlayer] YouTube video ID is unspecified!")}}function openExternalLinkInNewTab(){var e,t=document.querySelectorAll("a.is-external-link"),n=t.length;console.info(`[openExternalLinkInNewTab] ${1===n?"an":n} external link${1===n?" was":"s were"} found.`+(0!==n?" Setting attributes...":""));for(e of t)e.setAttribute("target","_blank"),e.setAttribute("rel","noopener")}function changeHeadingLinkIcons(){var t=document.querySelectorAll("a.toc-anchor"),e=t.length;console.info(`[changeHeadingLinkIcons] ${1===e?"a":e} header${1===e?" was":"s were"} found.`+(0!==e?" Changing icons...":""));for(let e of t)e.querySelector(".v-icon")||(e.textContent="",e.insertAdjacentHTML("afterbegin",'<div class="v-icon mdi mdi-link-variant"></div>'),e.addEventListener("click",()=>{copyToClipboard(e)}))}function copyToClipboard(e){let n=e.href;navigator.clipboard?navigator.clipboard.writeText(n).then(()=>{console.log("URL copied to clipboard:",n);var e=document.documentElement.lang||"ja",t={ja:"URLをクリップボードにコピーしました:\n","zh-tw":"URL已複製到剪貼簿:\n",en:"URL copied to clipboard:\n"};alert((t[e]||t.en)+decodeURI(n))}).catch(()=>{console.error("Clipboard write failed"),alert("URLのコピーに失敗しました。手動でコピーしてください。")}):(console.warn("Clipboard API is not supported in this browser."),alert("このブラウザではコピー機能がサポートされていません。リンクを手動でコピーしてください。"))}function convertImagesToFigures(){var e=Array.from(document.querySelectorAll(".contents > div > p")),t=["#text","img","br","em","strong","code","a"],n=t.filter(e=>"img"!==e);o=t,r=n;var o,r,a;for(a of e.filter(e=>!!Array.from(e.childNodes).every(e=>o.includes(e.nodeName.toLowerCase()))&&"img"===e.firstChild?.nodeName.toLowerCase()&&!!(e=e.lastChild)&&!!r.includes(e?.nodeName.toLowerCase()))){var i,d=(e=>{var t,n=[];let o=null;for(t of e.childNodes)"img"===t.nodeName.toLowerCase()?(o&&n.push(o),o={image:t,caption:[]}):o?.caption.push(t);return o&&n.push(o),n})(a),c=document.createElement("div");c.classList.add("images-row");for(i of d){for(var l,s=document.createElement("figure"),u=(s.appendChild(i.image),document.createElement("figcaption")),p=[...i.caption];"BR"===p[0].nodeName;)p.shift();for(;"BR"===p.at(-1)?.nodeName;)p.pop();for(l of p)u.appendChild(l);s.appendChild(u),c.appendChild(s)}a.replaceWith(c)}}function addImagePreview(){var e=document.querySelectorAll(".contents img");let r=(()=>{let e=document.createElement("dialog");var t=document.createElement("menu"),n=document.createElement("li"),o=document.createElement("li"),r=document.createElement("button"),a=document.createElement("button");let i=document.createElement("img");return r.textContent="閉じる",r.setAttribute("autofocus",""),r.addEventListener("click",()=>{e.close()}),n.appendChild(r),a.textContent="画像を新しいタブで開く",a.addEventListener("click",()=>{window.open(i.src)}),o.appendChild(a),t.append(n,o),e.append(t,i),document.body.appendChild(e),e})();for(let o of e)o.addEventListener("click",()=>{var{src:e,alt:t}=o,n=r.querySelector("img");n&&(n.src=e,n.alt=t,r.showModal())})}window.addEventListener("resize",adjustDescriptionAreaHeight),window.boot.register("page-ready",()=>{adjustDescriptionAreaHeight(),replaceWithYouTubeEmbeddedPlayer(),openExternalLinkInNewTab(),changeHeadingLinkIcons(),convertImagesToFigures(),addImagePreview()});